RVsing = c(7.83	,7.42	,7.89	,7.12	,7.88	,6.16	,7.26	, 6.71	,6.54	,4.75	,5.24	,4.86	,4.78	,6.05	,5.42	,4.21	,3.61	,
3.72	,3.87	,3.92	,3.13	,2.98	,2.85	,3.17	,3.09	,3.12	,5.92	,
6.42	,5.92	,6.27	,7.13	,6.62	,6.58	,6.93	,4.54	,4.81	,5.11	,5.29	,5.39	,5.57	,4.48	,4.92	,3.97	,4.22	,4.65	,4.74	,4.44	,4.5	,
6.78	,6.07	,6.52	,6.42	,6.41	,5.76	,5.06	,4.72	,4.9	,4.8	,4.9	,
5.1	)

ISsing = c(6.57	,5.62	,6.9	,6.57	,6.35	,4.06	,4.29	,4.26	,4.09	,4.71	,5.5	,5.08	,5.02	,6.01	,5.67	,4.14	,4.2	,4.61	,4.68	,5.04	,3.03	,2.86	,
2.77	,2.46	,2.32	,2.43	,5.9	,5.81	,5.7	,5.76	,5.09	,4.63	,4.61	,5.09	,4.72	,4.61	,4.36	,4.2	,4.36	,4.2	,3.17	,3.12	,2.96	,4.35	,
4.62	,3.16	,3.53	,3.53	,7.2	,6.09	,7	,7.1	,7.4	,6.8	,4.5	,4.2	,3.8	,3.8	,4.2	,4.5	)

#############################################################

RVave=c(7.628	,6.6675	,5.183333333	,3.866	,3.056666667	,6.1325	,6.815	,5.028	,4.456666667	,4.51	,6.326666667	,4.913333333	)

ISave=c(6.402	,4.175	,5.331666667	,4.534	,2.645	,5.7925	,4.855	,4.45	,3.083333333	,3.838	,6.931666667	,4.166666667	)

#############################################################

X=RVsing
Y=ISsing

n=length(X)

As=(Y+X)/2
Ds=(X-Y)
plot(As,Ds)
abline(h=0)
abline(h=mean(Ds), lty=3)
Cs=As-mean(As)
SLR=lm(Ds~Cs)
summary(SLR)


#            Estimate Std. Error t value Pr(>|t|)  
#(Intercept) -0.23333    0.97874  -0.238   0.8133  
#Cs           0.09250    0.04991   1.853   0.0744 .


to=c(0,0)
t1=c(0,0)
summary(SLR)$coefficients[,3]
dist = sum(summary(SLR)$coefficients[,3]^2)


dist = sum(summary(SLR)$coefficients[,3]^2)
to[2]=summary(SLR)$coefficients[5]
t1[2]=summary(SLR)$coefficients[6]
r =sqrt(2*qf(0.95,2,n-2))
tcrit=qt(0.95,n-1)

as.numeric(abs(to[2])<=tcrit)
as.numeric(abs(t1[2])<=tcrit)
as.numeric(dist<=r)
#############################################################



plot(x=to,y=t1, xlim=c(-6,6),ylim=c(-6,6))
abline(h=0,col=2,lty=2)
abline(v=0,col=2,lty=2)



zone=qt(0.95,n-1)
abline(h=zone,col=3,lty=2)
abline(h=-zone,col=3,lty=2)
abline(v=zone,col=3,lty=2)


# Cardiac output by two methods,
# RV and IC, for 12 subjects

cardiac = matrix(data = 
c(1, 7.83, 6.57,
1, 7.42, 5.62,
1, 7.89, 6.90,
1, 7.12, 6.57,
1, 7.88, 6.35,
2, 6.16, 4.06,
2, 7.26, 4.29,
2, 6.71, 4.26,
2, 6.54, 4.09,
3, 4.75, 4.71,
3, 5.24, 5.50,
3, 4.86, 5.08,
3, 4.78, 5.02,
3, 6.05, 6.01,
3, 5.42, 5.67,
4, 4.21, 4.14,
4, 3.61, 4.20,
4, 3.72, 4.61,
4, 3.87, 4.68,
4, 3.92, 5.04,
5, 3.13, 3.03,
5, 2.98, 2.86,
5, 2.85, 2.77,
5, 3.17, 2.46,
5, 3.09, 2.32,
5, 3.12, 2.43,
6, 5.92, 5.90,
6, 6.42, 5.81,
6, 5.92, 5.70,
6, 6.27, 5.76,
7, 7.13, 5.09,
7, 6.62, 4.63,
7, 6.58, 4.61,
7, 6.93, 5.09,
8, 4.54, 4.72,
8, 4.81, 4.61,
8, 5.11, 4.36,
8, 5.29, 4.20,
8, 5.39, 4.36,
8, 5.57, 4.20,
9, 4.48, 3.17,
9, 4.92, 3.12,
9, 3.97, 2.96,
10, 4.22, 4.35,
10, 4.65, 4.62,
10, 4.74, 3.16,
10, 4.44, 3.53,
10, 4.50, 3.53,
11, 6.78, 7.20,
11, 6.07, 6.09,
11, 6.52, 7.00,
11, 6.42, 7.10,
11, 6.41, 7.40,
11, 5.76, 6.80,
12, 5.06, 4.50,
12, 4.72, 4.20,
12, 4.90, 3.80,
12, 4.80, 3.80,
12, 4.90, 4.20,
12, 5.10, 4.50),
ncol=3, byrow = TRUE,
dimnames = list(NULL,
c("Subject", "RV", "IS")))

abline(v=-zone,col=3,lty=2)

